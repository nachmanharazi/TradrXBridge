# ResetAndInstallDocker.ps1
Write-Host "ğŸ“¦ ××™×¤×•×¡ ××•×—×œ×˜ ×•×”×ª×§× ×” ×©×œ Docker..." -ForegroundColor Cyan

# ×©×œ×‘ 1: ××—×™×§×ª ×›×œ ×”×ª×§× ×” ×™×©× ×”
$pathsToDelete = @(
  "C:\Program Files\Docker",
  "$env:USERPROFILE\AppData\Local\Docker",
  "$env:USERPROFILE\AppData\Roaming\Docker"
)

foreach ($path in $pathsToDelete) {
  if (Test-Path $path) {
    Remove-Item -Recurse -Force $path
    Write-Host "ğŸ§¹ × ××—×§: $path" -ForegroundColor Yellow
  } else {
    Write-Host "âœ”ï¸ ×œ× × ××¦× (×›×‘×¨ × ×§×™): $path" -ForegroundColor Green
  }
}

# ×©×œ×‘ 2: ×‘×“×™×§×ª WSL2
Write-Host "ğŸ” ×‘×•×“×§ ×©Ö¾WSL2 ××•×ª×§×Ÿ..." -ForegroundColor Cyan
$wslInstalled = wsl.exe --version -ErrorAction SilentlyContinue

if (-not $?) {
  Write-Host "â— WSL2 ×œ× ××•×ª×§×Ÿ. ×¤×ª×— PowerShell ×›×× ×”×œ ×•×”×¨×¥: wsl --install" -ForegroundColor Red
  exit
} else {
  Write-Host "âœ… WSL2 ××•×ª×§×Ÿ." -ForegroundColor Green
}

# ×©×œ×‘ 3: ×”×•×¨×“×ª Docker Installer
$installerUrl = "https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe"
$installerPath = "$env:TEMP\DockerInstaller.exe"
Write-Host "â¬‡ï¸ ××•×¨×™×“ ××ª Docker..." -ForegroundColor Cyan

Invoke-WebRequest -Uri $installerUrl -OutFile $installerPath

if (-Not (Test-Path $installerPath)) {
  Write-Host "âŒ ×”×•×¨×“×” × ×›×©×œ×”." -ForegroundColor Red
  exit
}

Write-Host "âœ… ×”×”×•×¨×“×” ×”×¡×ª×™×™××”." -ForegroundColor Green

# ×©×œ×‘ 4: ×”×ª×§× ×” ××—×“×©
Write-Host "ğŸš€ ××ª×§×™×Ÿ Docker ×¢× ×”×¨×©××•×ª ×× ×”×œ..." -ForegroundColor Cyan

Start-Process -FilePath $installerPath -ArgumentList "install --quiet --accept-license" -Verb RunAs -Wait

# ×©×œ×‘ 5: ×‘×“×™×§×ª Docker
Start-Sleep -Seconds 10
Write-Host "ğŸ§ª ×‘×•×“×§ ×× Docker ××•×ª×§×Ÿ ×›×¨××•×™..." -ForegroundColor Cyan

$dockerVersion = & "$env:ProgramFiles\Docker\Docker\resources\bin\docker.exe" --version 2>$null

if ($dockerVersion) {
  Write-Host "âœ… Docker ×”×•×ª×§×Ÿ ×‘×”×¦×œ×—×”:" -ForegroundColor Green
  Write-Host $dockerVersion -ForegroundColor White
} else {
  Write-Host "âŒ Docker ×¢×“×™×™×Ÿ ×œ× ××–×•×”×”. ×™×™×ª×›×Ÿ ×©×¦×¨×™×š ×”×¤×¢×œ×” ××—×“×©." -ForegroundColor Red
}

Write-Host "ğŸ” ××•××œ×¥ ×œ×”×¤×¢×™×œ ××ª ×”××—×©×‘ ××—×“×© ×¢×›×©×™×•." -ForegroundColor Yellow

